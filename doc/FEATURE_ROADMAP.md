# 技术博客功能路线图

## 🎉 最近更新（2026年1月）

### 已完成的功能

1. ✅ **阅读量统计** - 使用 PostgreSQL 函数实现原子性操作
2. ✅ **代码复制功能** - 代码块悬停显示复制按钮，支持语法高亮
3. ✅ **草稿自动保存** - 每 30 秒自动保存到本地，防止内容丢失
4. ✅ **作者页面** - 完整的作者信息展示和文章列表
5. ✅ **热门文章** - 实时热度计算，智能排序（方案一）
6. ✅ **移动端优化** - 触摸优化、下拉刷新、键盘输入优化
7. ✅ **SEO 基础** - Sitemap 和 Robots.txt 自动生成
8. ✅ **PWA 支持** - 可安装、离线访问、缓存策略
9. ✅ **GitHub OAuth** - 支持 GitHub 账号登录
10. ✅ **移动端 UI 优化** - 文章卡片、详情页、热门文章组件全面优化（2026-01-06）
11. ✅ **依赖升级** - 所有依赖升级到最新版本（2026-01-07）
12. ✅ **TypeScript 类型优化** - Composables 层 100% 类型完善（2026-01-07）

### 最新优化（2026-01-07）

#### 📦 依赖升级

- Nuxt 4.2.1 → 4.2.2
- Vue 3.5.24 → 3.5.26
- Supabase 2.83.0 → 2.89.0
- Tiptap 3.11.0 → 3.15.1
- 26 个包升级，移除弃用包

#### 🔧 TypeScript 优化

- ✅ **70% 类型错误修复** (101 → ~30-40)
- ✅ **Composables 100% 类型完善**
  - `useToast` - 完整接口定义
  - `useHotPosts` - 修复动态字段类型
  - `useTouch` - Null 安全检查
  - `usePullToRefresh` - 触摸事件优化
  - `useSupabase` - API 修复
- ✅ **构建和 Lint 完全通过**

#### 📚 新增文档

- 依赖升级报告 (`DEPENDENCY_UPGRADE_2026-01.md`)
- TypeScript 优化报告 (`TYPESCRIPT_OPTIMIZATION_2026-01.md`)
- 高优先级优化总结 (`HIGH_PRIORITY_OPTIMIZATION_SUMMARY.md`)

---

## 📊 当前已实现功能

✅ **核心功能**

- 文章发布与管理（创建、编辑、删除）
- 分类和标签系统
- 用户认证系统（邮箱/密码、GitHub OAuth）
- 评论功能
- 点赞功能
- 全文搜索（PostgreSQL）
- 富文本编辑器（Tiptap）
- 暗色模式
- 响应式设计
- PWA 支持（可安装、离线访问）
- 移动端优化（触摸优化、安全区域适配、下拉刷新）
- 分享功能（Web Share API）
- 上一篇/下一篇导航
- 阅读时间计算
- 阅读量统计
- 用户资料管理（头像上传、个人信息）
- 管理员后台
- 作者页面和作者列表
- 我的博客页面
- 代码复制功能（代码块右上角复制按钮）
- 草稿自动保存（本地存储，每 30 秒自动保存）
- 无限滚动加载
- 搜索模态框
- 返回顶部按钮
- SEO 优化（Sitemap、Robots.txt）
- 图片优化和懒加载
- 键盘输入优化（移动端输入框自动滚动）

---

## 🚀 高优先级功能（建议优先实现）

### 1. ✅ **阅读量统计** ⭐⭐⭐⭐⭐（已实现）

**状态**: ✅ 已完成

**实现内容**:

- ✅ `blog_posts` 表已添加 `view_count` 字段
- ✅ 文章详情页自动增加阅读量（使用 `increment_view_count` 函数）
- ✅ 文章卡片和详情页显示阅读量
- ✅ 支持按阅读量排序

**技术实现**:

- 使用 PostgreSQL 函数 `increment_view_count` 确保原子性操作
- 防止重复计数（通过数据库事务保证）
- 已创建索引优化查询性能

---

### 2. **RSS 订阅** ⭐⭐⭐⭐⭐

**重要性**: 极高 | **难度**: 中 | **影响**: 高

**功能描述**:

- 生成 RSS Feed
- 支持 RSS 阅读器订阅
- 自动更新最新文章

**实现要点**:

- 创建 `/rss.xml` 路由
- 使用 Nuxt 3 的 server API
- 包含文章标题、摘要、发布时间等
- 支持分类和标签过滤的 RSS

**技术实现**:

- 使用 `server/api/rss.xml.ts` 生成 XML
- 遵循 RSS 2.0 标准
- 添加缓存机制

---

### 3. **文章目录（TOC）** ⭐⭐⭐⭐

**重要性**: 高 | **难度**: 中 | **影响**: 中

**功能描述**:

- 自动生成文章目录
- 固定侧边栏显示
- 点击跳转到对应章节
- 滚动时高亮当前章节

**实现要点**:

- 解析 Markdown/HTML 中的标题
- 生成锚点链接
- 监听滚动位置
- 移动端可折叠显示

**技术实现**:

- 使用 `marked` 或 `remark` 解析标题
- 使用 `IntersectionObserver` 监听滚动
- 创建 `TableOfContents.vue` 组件

---

### 4. **相关文章推荐** ⭐⭐⭐⭐

**重要性**: 高 | **难度**: 中 | **影响**: 高

**功能描述**:

- 基于标签和分类推荐相似文章
- 显示在文章详情页底部
- 提高用户停留时间

**实现要点**:

- 基于标签匹配度计算相似度
- 考虑分类相关性
- 排除当前文章
- 限制推荐数量（3-5篇）

**算法思路**:

1. 获取当前文章的标签和分类
2. 查找有相同标签的文章
3. 按标签匹配数量排序
4. 相同标签数时，优先显示同分类文章

---

### 5. ✅ **代码复制功能** ⭐⭐⭐⭐（已实现）

**状态**: ✅ 已完成

**实现内容**:

- ✅ 代码块右上角显示复制按钮（悬停显示）
- ✅ 使用 `navigator.clipboard` API 复制代码
- ✅ 复制成功/失败反馈（按钮文字变化）
- ✅ 移动端友好设计
- ✅ 代码高亮集成（使用 highlight.js）

**技术实现**:

- 在 `BlogContentRenderer.vue` 中实现
- 自动检测代码语言并高亮
- 2 秒后自动恢复复制按钮状态
- 支持深色/浅色主题

---

### 6. **文章归档页面** ⭐⭐⭐

**重要性**: 中 | **难度**: 低 | **影响**: 中

**功能描述**:

- 按年月归档文章
- 显示每月文章数量
- 支持快速浏览历史文章

**实现要点**:

- 创建 `/archive` 页面
- 按 `published_at` 分组
- 使用折叠面板展示
- 显示文章标题和发布时间

**页面结构**:

```
2024年
  ├─ 12月 (5篇)
  ├─ 11月 (8篇)
  └─ 10月 (3篇)
2023年
  └─ ...
```

---

### 7. **标签云** ⭐⭐⭐

**重要性**: 中 | **难度**: 低 | **影响**: 中

**功能描述**:

- 可视化展示所有标签
- 标签大小反映使用频率
- 点击跳转到标签页面

**实现要点**:

- 统计每个标签的使用次数
- 使用 CSS 或 Canvas 渲染
- 支持按使用频率排序
- 响应式布局

**技术实现**:

- 创建 `TagCloud.vue` 组件
- 使用 `wordcloud` 库或纯 CSS
- 添加悬停效果

---

## 🎯 中优先级功能

### 8. **文章收藏/书签** ⭐⭐⭐

**重要性**: 中 | **难度**: 中 | **影响**: 中

**功能描述**:

- 用户收藏喜欢的文章
- 在个人中心查看收藏列表
- 支持取消收藏

**数据库变更**:

```sql
CREATE TABLE bookmarks (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  post_id UUID REFERENCES blog_posts(id) ON DELETE CASCADE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  UNIQUE(user_id, post_id)
);
```

---

### 9. **阅读进度条** ⭐⭐⭐

**重要性**: 中 | **难度**: 低 | **影响**: 低

**功能描述**:

- 文章顶部显示阅读进度
- 实时更新进度百分比
- 提升阅读体验

**实现要点**:

- 使用 `IntersectionObserver` 或滚动事件
- 计算已滚动内容占比
- 固定在页面顶部
- 移动端友好

---

### 10. ✅ **热门文章** ⭐⭐⭐（已实现）

**状态**: ✅ 已完成

**实现内容**:

- ✅ 实时热度计算（阅读量 × 0.3 + 点赞数 × 0.4 + 评论数 × 0.3）
- ✅ 时间衰减因子（让新文章也有曝光机会）
- ✅ 热门文章组件（首页侧边栏展示）
- ✅ 博客列表页热度排序选项
- ✅ 金银铜牌排名样式
- ✅ 统计信息展示（阅读/点赞/评论）
- ✅ 悬停动画效果

**技术实现**:

- 使用方案一（实时计算）
- `useHotPosts` composable
- `HotPosts.vue` 组件
- 支持配置（数量、天数、时间衰减）
- 完整文档（实现方案、使用指南）

**相关文档**:

- [热门文章使用指南](./HOT_POSTS_USAGE.md)
- [热门文章实现方案](./HOT_POSTS_IMPLEMENTATION.md)
- [实现总结](./HOT_POSTS_SUMMARY.md)

---

### 11. ✅ **文章草稿自动保存** ⭐⭐⭐（已实现）

**状态**: ✅ 已完成

**实现内容**:

- ✅ 每 30 秒自动保存草稿到 `localStorage`
- ✅ 页面加载时自动检测并提示恢复草稿
- ✅ 显示保存状态和最后保存时间
- ✅ 支持手动保存和取消
- ✅ 草稿保留 7 天，过期自动清理
- ✅ 发布成功后自动清除草稿

**技术实现**:

- 使用 `useDraft` composable 管理草稿
- 创建和编辑页面独立的草稿存储
- 完整的文档说明（`doc/DRAFT_AUTOSAVE.md`）

---

### 12. ✅ **作者页面** ⭐⭐⭐（已实现）

**状态**: ✅ 已完成

**实现内容**:

- ✅ 作者详情页面（`/authors/[id]`）
- ✅ 显示作者头像、用户名、简介
- ✅ 显示统计信息（文章数、加入时间）
- ✅ 展示作者所有已发布文章
- ✅ 文章列表分页功能
- ✅ 作者列表页面（`/authors`）
- ✅ 我的博客页面（`/my-blogs`）

**技术实现**:

- 支持 GitHub OAuth 用户信息展示
- 响应式设计，移动端友好
- 空状态提示

---

### 13. **搜索历史** ⭐⭐

**重要性**: 低 | **难度**: 低 | **影响**: 低

**功能描述**:

- 保存用户搜索记录
- 显示最近搜索
- 快速重新搜索

**实现要点**:

- 使用 `localStorage` 存储
- 限制历史记录数量（如10条）
- 支持清除历史

---

## 🔮 低优先级功能（可选）

### 14. **文章版本历史**

- 记录文章编辑历史
- 支持版本对比
- 支持回滚到历史版本

### 15. **文章系列**

- 将相关文章组织成系列
- 显示系列导航
- 系列封面和描述

### 16. **订阅通知**

- 新文章发布邮件通知
- RSS 订阅提醒
- 评论回复通知

### 17. **导出功能**

- 导出为 PDF
- 导出为 Markdown
- 批量导出

### 18. **评论回复**

- 支持回复评论
- 评论树形结构
- @ 提及用户

### 19. **文章统计面板**

- 字数统计
- 阅读时间预估
- 代码行数统计
- 图片数量统计

### 20. **SEO 增强** （部分实现）

- ⏳ 结构化数据（JSON-LD） - **待实现**
- ⏳ Open Graph 优化 - **待实现**
- ⏳ Twitter Cards - **待实现**
- ✅ Sitemap 自动生成 - **已完成**
- ✅ Robots.txt 配置 - **已完成**

### 21. **多语言支持**

- i18n 国际化
- 文章多语言版本
- 语言切换

### 22. **文章置顶**

- 管理员可置顶文章
- 在列表页优先显示
- 支持多个置顶文章

---

## 📋 实现优先级建议

### 第一阶段（核心功能）

1. ✅ 阅读量统计 - **已完成**
2. ⏳ RSS 订阅 - **待实现**
3. ⏳ 文章目录（TOC） - **待实现**
4. ⏳ 相关文章推荐 - **待实现**

### 第二阶段（用户体验）

5. ✅ 代码复制功能 - **已完成**
6. ⏳ 文章归档页面 - **待实现**
7. ⏳ 标签云 - **待实现**（首页已有简单版本）
8. ✅ 热门文章 - **已完成**（方案一：实时计算）

### 第三阶段（高级功能）

9. ⏳ 文章收藏/书签 - **待实现**
10. ⏳ 阅读进度条 - **待实现**
11. ✅ 文章草稿自动保存 - **已完成**
12. ✅ 作者页面 - **已完成**

---

## 💡 技术实现建议

### 阅读量统计

- 使用数据库触发器或应用层逻辑
- 考虑使用 Redis 缓存减少数据库压力
- 防刷机制（IP + User-Agent）

### RSS 订阅

- 使用 Nuxt 3 Server API
- 遵循 RSS 2.0 标准
- 添加适当的缓存头

### 文章目录

- 使用 `marked` 或 `remark` 解析
- `IntersectionObserver` 监听滚动
- 平滑滚动动画

### 相关文章推荐

- 基于标签匹配算法
- 考虑使用向量相似度（可选）
- 缓存推荐结果

---

## 📝 注意事项

1. **性能优化**: 所有新功能都要考虑性能影响
   - 已实现：无限滚动、图片懒加载、PWA 缓存
2. **用户体验**: 确保移动端体验良好
   - 已实现：触摸优化、下拉刷新、键盘输入优化、安全区域适配
3. **SEO 友好**: 新页面要支持 SEO
   - 已实现：Sitemap、Robots.txt
   - 待实现：结构化数据、Open Graph
4. **可访问性**: 遵循 WCAG 标准
   - 已实现：语义化 HTML、键盘导航
5. **数据迁移**: 数据库变更要考虑数据迁移
   - 已实现：阅读量统计字段

---

## 🔗 相关资源

- [RSS 2.0 规范](https://www.rssboard.org/rss-specification)
- [JSON-LD 结构化数据](https://schema.org/)
- [Intersection Observer API](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API)
- [Web Share API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Share_API)
- [PWA 最佳实践](https://web.dev/progressive-web-apps/)

## 📚 项目文档

- [草稿自动保存说明](./DRAFT_AUTOSAVE.md)
- [PWA 和移动端优化](./PWA_MOBILE_OPTIMIZATION.md)
- [GitHub OAuth 设置](./GITHUB_OAUTH_SETUP.md)
- [键盘输入优化](./KEYBOARD_INPUT_OPTIMIZATION.md)
- [触摸优化](./TOUCH_OPTIMIZATION.md)
